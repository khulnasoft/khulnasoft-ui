pre-push:
  parallel: true
  commands:
    eslint:
      files: git diff --name-only --diff-filter=d origin/main...HEAD
      glob: '*.{js,vue}'
      run: |
        if [ -n "{files}" ]; then
          ./node_modules/.bin/eslint {files}
        else
          echo "No ESLint files to check"
        fi
    prettier:
      files: git diff --name-only --diff-filter=d origin/main...HEAD
      glob: '*.{js,vue}'
      run: |
        if [ -n "{files}" ]; then
          ./node_modules/.bin/prettier --check {files}
        else
          echo "No Prettier files to check"
        fi
    stylelint:
      files: git diff --name-only --diff-filter=d origin/main...HEAD
      glob: '*.{scss}'
      run: |
        if [ -n "{files}" ]; then
          ./node_modules/.bin/stylelint {files}
        else
          echo "No Stylelint files to check"
        fi
    markdown-lint:
      glob: '*.md'
      run: yarn markdownlint
    yarn-deduplicate:
      glob: 'yarn.lock'
      run: yarn yarn-deduplicate --strategy fewer --list --fail

pre-commit:
  commands:
    generate_translations:
      files: git diff --name-only --staged
      glob: '*.{js,vue}'
      run: yarn translations:collect && git add ./translations.js
    build_tokens:
      files: git diff --name-only --staged
      glob: '*.tokens.json'
      run: node ./bin/build_tokens.mjs && git add ./src/tokens/build
